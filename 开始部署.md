# 🚀 开始部署 - 分步指南

## 📋 部署流程概览

1. ✅ 代码已上传到 GitHub (kivvng726/cosmic-resonance)
2. ⏳ 部署后端到 Railway
3. ⏳ 更新前端配置
4. ⏳ 部署前端到 Vercel

---

## 第一步：部署后端到 Railway

### 步骤 1: 访问 Railway

1. 打开浏览器，访问：**https://railway.app**
2. 点击右上角 **"Login"** 或 **"Start a New Project"**
3. 选择 **"Login with GitHub"**
4. 授权 Railway 访问你的 GitHub 账号

### 步骤 2: 创建新项目

1. 登录后，点击 **"New Project"** 按钮
2. 选择 **"Deploy from GitHub repo"**
3. 在仓库列表中找到 **`kivvng726/cosmic-resonance`**
4. 点击仓库名称

### 步骤 3: 配置项目

Railway 会自动检测到你的项目，现在需要配置：

1. **设置 Root Directory**：
   - 在项目设置中找到 **"Settings"** 标签
   - 找到 **"Root Directory"** 选项
   - 点击 **"Change"**，输入：`backend`
   - 点击 **"Save"**

2. **配置环境变量**：
   - 在项目页面，点击 **"Variables"** 标签
   - 点击 **"+ New Variable"** 添加以下变量：
   
   ```
   变量名: OPENAI_API_KEY
   值: sk-8o2rqoIlnYDrWd0amiXacpT4Vs0XGSzOIg4ZBMzJ2IxsDXSU
   ```
   
   ```
   变量名: OPENAI_BASE_URL
   值: https://api.moonshot.cn/v1
   ```
   
   ```
   变量名: OPENAI_MODEL
   值: moonshot-v1-8k
   ```
   
   ```
   变量名: API_HOST
   值: 0.0.0.0
   ```

3. **配置启动命令**：
   - 在 **"Settings"** → **"Deploy"** 标签
   - 找到 **"Start Command"**
   - 输入：`uvicorn app.main:app --host 0.0.0.0 --port $PORT`
   - 点击 **"Save"**

### 步骤 4: 等待部署

1. Railway 会自动开始部署
2. 在 **"Deployments"** 标签可以看到部署进度
3. 等待 2-5 分钟，直到状态变为 **"Success"**

### 步骤 5: 获取后端地址

1. 部署完成后，在项目页面找到 **"Settings"** → **"Networking"**
2. 找到 **"Public Domain"** 或 **"Generate Domain"**
3. 点击生成域名，会得到一个类似这样的地址：
   ```
   https://cosmic-resonance-production.up.railway.app
   ```
4. **重要**：复制这个地址，稍后需要用到！

### 步骤 6: 测试后端

1. 在浏览器中访问：`https://你的railway域名/api/health`
2. 应该返回：
   ```json
   {"status":"healthy","timestamp":"..."}
   ```
3. 如果正常，说明后端部署成功！✅

---

## 第二步：更新前端配置

完成第一步后，告诉我你的 Railway 后端地址，我会帮你更新前端配置。

或者你可以自己操作：

1. 编辑 `index.html` 文件
2. 找到这一行：
   ```javascript
   : 'https://YOUR_BACKEND_URL_HERE';
   ```
3. 替换为你的 Railway 地址：
   ```javascript
   : 'https://你的railway域名.up.railway.app';
   ```
4. 保存文件

---

## 第三步：部署前端到 Vercel

完成第二步后，继续部署前端。

---

## ⏸️ 现在开始第一步

请按照上面的步骤，先完成 **第一步：部署后端到 Railway**。

完成后告诉我：
1. 你的 Railway 后端地址
2. 健康检查是否通过

然后我会帮你继续下一步！

