# 部署检查清单

## ✅ 部署前检查

### 代码准备
- [ ] 所有代码已提交到 GitHub
- [ ] `.env` 文件已添加到 `.gitignore`
- [ ] 前端 API 地址已更新（或使用环境变量）
- [ ] 后端 CORS 配置正确

### 环境变量准备
- [ ] 月之暗面 API Key 已准备好
- [ ] 知道需要配置哪些环境变量

---

## 🚂 Railway 后端部署检查

### 项目配置
- [ ] Root Directory 设置为 `backend`
- [ ] Start Command 设置为 `uvicorn app.main:app --host 0.0.0.0 --port $PORT`

### 环境变量
- [ ] `OPENAI_API_KEY` 已设置
- [ ] `OPENAI_BASE_URL` 已设置为 `https://api.moonshot.cn/v1`
- [ ] `OPENAI_MODEL` 已设置为 `moonshot-v1-8k`
- [ ] `API_HOST` 已设置为 `0.0.0.0`
- [ ] `API_PORT` 使用 `$PORT`（Railway 自动提供）

### 部署后测试
- [ ] 健康检查通过：`https://你的域名/api/health`
- [ ] API 文档可访问：`https://你的域名/docs`
- [ ] 测试占卜 API：`POST /api/divination/start`

---

## 🌐 Vercel 前端部署检查

### 项目配置
- [ ] Framework Preset 选择 "Other"
- [ ] Root Directory 为 `./`
- [ ] Build Command 留空
- [ ] Output Directory 留空

### 代码更新
- [ ] `index.html` 中的 API 地址已更新为 Railway 后端地址
- [ ] 或配置了环境变量 `API_BASE_URL`

### 部署后测试
- [ ] 前端页面可以正常访问
- [ ] 3D 星空功能正常
- [ ] 占卜功能可以调用后端
- [ ] 浏览器控制台没有 CORS 错误
- [ ] 浏览器控制台没有网络错误

---

## 🔗 集成测试

### 功能测试
- [ ] 输入出生日期和问题
- [ ] 点击"开始占卜"
- [ ] 占卜流程正常执行
- [ ] 显示天文数据（星座、月相等）
- [ ] 显示传统文化数据（八字、紫微、签文）
- [ ] 显示 AI 生成的解读
- [ ] 所有数据格式正确

### 跨平台测试
- [ ] 在 Chrome 浏览器测试
- [ ] 在 Firefox 浏览器测试
- [ ] 在手机浏览器测试（可选）
- [ ] 在不同网络环境下测试

---

## 🔒 安全检查

### API Key 安全
- [ ] API Key 没有提交到 GitHub
- [ ] `.env` 文件在 `.gitignore` 中
- [ ] 环境变量在平台中正确配置

### CORS 安全
- [ ] 生产环境 CORS 配置了具体的前端域名
- [ ] 不允许所有来源（`*`）在生产环境使用

### HTTPS
- [ ] 前端使用 HTTPS
- [ ] 后端使用 HTTPS
- [ ] API 调用使用 HTTPS

---

## 📊 性能检查

### 加载速度
- [ ] 前端页面加载速度正常
- [ ] 3D 场景渲染流畅
- [ ] API 响应时间合理（< 10 秒）

### 资源加载
- [ ] 所有 CSS 文件正常加载
- [ ] 所有 JS 文件正常加载
- [ ] CDN 资源（Three.js, GSAP）正常加载

---

## 🐛 常见问题检查

### 如果前端无法连接后端
- [ ] 检查后端 URL 是否正确
- [ ] 检查后端服务是否运行
- [ ] 检查 CORS 配置
- [ ] 查看浏览器控制台错误

### 如果 API 返回错误
- [ ] 检查环境变量是否正确
- [ ] 检查 API Key 是否有效
- [ ] 查看后端日志
- [ ] 测试健康检查端点

### 如果部署失败
- [ ] 查看部署日志
- [ ] 检查 `requirements.txt` 是否正确
- [ ] 检查代码语法错误
- [ ] 检查启动命令是否正确

---

## 📝 部署后记录

部署完成后，记录以下信息：

- **前端地址**: `https://xxx.vercel.app`
- **后端地址**: `https://xxx.up.railway.app`
- **部署日期**: `YYYY-MM-DD`
- **部署版本**: `v1.0.0`（或其他版本号）

---

## ✅ 完成确认

所有检查项完成后，你的应用就可以正式使用了！

**分享链接**: `https://你的前端地址.vercel.app`

🎉 恭喜！部署完成！

